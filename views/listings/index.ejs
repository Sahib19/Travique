<% layout("/layouts/boilerplate") %>

  <body style="background-color: #f8f9fa;">
    <!-- Hero Section -->
    <div class="hero-section">
      <div class="container">
        <div class="text-center py-5">
          <h1 class="hero-title">Discover Amazing Places</h1>
          <p class="hero-subtitle">Find your next adventure with our curated collection of unique destinations</p>
        </div>
      </div>
    </div>

    <!-- Filter Section -->
    <div class="container">
      <div id="filters">
        <div class="filter filter-active">
          <i class="fa-solid fa-earth-americas"></i>
          <p>All</p>
        </div>

        <div class="filter">
          <i class="fa-solid fa-fire"></i>
          <p>Trending</p>
        </div>

        <div class="filter">
          <i class="fa-solid fa-bed"></i>
          <p>Rooms</p>
        </div>

        <div class="filter">
          <i class="fa-solid fa-mountain-city"></i>
          <p>Iconic Cities</p>
        </div>

        <div class="filter">
          <i class="fa-solid fa-mountain"></i>
          <p>Mountains</p>
        </div>

        <div class="filter">
          <i class="fa-solid fa-tree"></i>
          <p>Forest</p>
        </div>

        <div class="filter">
          <i class="fa-solid fa-gopuram"></i>
          <p>Heritage Sites</p>
        </div>

        <div class="filter">
          <i class="fa-solid fa-person-swimming"></i>
          <p>Amazing Pools</p>
        </div>

        <div class="filter">
          <i class="fa-solid fa-campground"></i>
          <p>Camping</p>
        </div>

        <div class="filter">
          <i class="fa-solid fa-cow"></i>
          <p>Farms</p>
        </div>

        <div class="filter">
          <i class="fa-solid fa-snowflake"></i>
          <p>Artic</p>
        </div>
      </div>
    </div>

    <!-- Listings Section -->
    <div class="container py-5">
      <%if(listingCount===0){ %>
        <div class="row justify-content-center">
          <div class="col-12 col-md-8 col-lg-6">
            <div class="card border-0 shadow-sm text-center">
              <div class="card-body p-5">
                <img
                  src="https://static.vecteezy.com/system/resources/previews/007/104/553/non_2x/search-no-result-not-found-concept-illustration-flat-design-eps10-modern-graphic-element-for-landing-page-empty-state-ui-infographic-icon-vector.jpg"
                  alt="No results" class="mb-4" style="width: 130px; height: auto;">

                <h4 class="card-title text-muted mb-3">No Listings Found</h4>
                <p class="card-text text-secondary mb-4">
                  It looks like there are no listings under <strong><%= category %></strong>.
                  Try browsing all available listings instead.
                </p>

                <a href="/listing" class="btn btn-outline-danger search-button">
                  View All Listings
                </a>
              </div>
            </div>
          </div>
        </div>

      <% } else { %>
        <!-- Listings Grid -->
        <div class="row g-4">
          <% for(let list of allListing) { %>
            <div class="col-12 col-sm-6 col-lg-4 col-xl-3">
              <div class="card-single">
                <div class="card h-100">
                  <div class="image-div position-relative">
                    <a href="/listing/<%= list._id %>" class="text-decoration-none">
                      <img src="<%= list.image.url %>" class="card-img-top" alt="<%= list.title %>">
                    </a>

                    <!-- Wishlist Heart Icon -->
                    <% if(currentUser) { %>
                      <%
                        let isInWishlist = false;
                        if(currentUser.wishlist) {
                          isInWishlist = currentUser.wishlist.some(item =>
                            item._id ? item._id.toString() === list._id.toString() : item.toString() === list._id.toString()
                          );
                        }
                      %>
                      <button class="wishlist-btn <%= isInWishlist ? 'active' : '' %>"
                              data-listing-id="<%= list._id %>"
                              onclick="toggleWishlist('<%= list._id %>', this)">
                        <i class="fa-solid fa-heart"></i>
                      </button>
                    <% } %>
                  </div>

                  <a href="/listing/<%= list._id %>" class="text-decoration-none">
                    <div class="card-text">
                      <span class="place"><%= list.title %></span>
                      <span class="price">â‚¹ <%= list.price ? list.price.toLocaleString("en-IN") : 0 %></span>
                    </div>
                  </a>
                </div>
              </div>
            </div>
          <% } %>
        </div>
      <% } %>
    </div>

    <!-- script tag for filter logic -->
    <script src="/js/filter.js"></script>
  </body>

</html>
